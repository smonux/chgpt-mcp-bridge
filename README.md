# MCP OAuth Proxy for ChatGPT

This is just a quick hack, I don't plan to maintain it, but I'm finding it useful. Feel free to fork.

## IMPORTANT: SECURITY CONSIDERATIONS  (Don't skip this)

If you use this software and follow these instructions, you are going to open your local machine to a non-deterministic, non-reliable piece of software **and** to the wild Internet, with your presence fully announced to any malicious bot out there (if you are familiar with the Dark Forest theory, I think it's a pretty good analogy).

If something bad happens, you have warned.

Still, if you follow this recommendations:

  - you run it within a VM (VirtualBox, Lima, whatever) or in a disposable machine (RPi) sharing just what you need the LLM to know
  - you use the source IP filtering mechanism
  - you drop the tunnel when you aren't using it
  - you obfuscate the url (security through obscurity gets a lot of bad press but for untargeted attacks it's very effective)

I think you wouldn't be totally mad if you decide to run it (still a little bit).

## Introduction

What it is: A lightweight **GitHub OAuth-protected proxy** built with [FastMCP](https://pypi.org/project/fastmcp/) to securely expose Model Context Protocol (MCP) tools to ChatGPT.

What problem solves:

ChatGPT as of today (October 2025) does support MCP in what it calls "Developer Mode" with these restrictions:
  - Only remote endpoints (https secured and Internet-reachable). No local (stdio) support.
  - The authentication options are:
    * None (unsecured endpoints)
    * OAuth protected
    * Notably missing: "simple" Bearer API keys are not supported (unlike in GPT Actions where they are available)

These restrictions make it difficult to use it for personal needs like Claude Desktop openly allows.

This script allows to run a proxy that supports GitHub as an OAuth provider, and forwards requests to local (stdio) mcp servers. Only GitHub users that are authenticated **and** in an allowed user list may use the services.

For enhaced security it allows to keep a list of permitted ip ranges. This way only connections that originate from OpenAI are permitted (OpenAI publishes their CIDR ranges in https://openai.com/chatgpt-actions.json).

This NOT solves the **valid https and Internet reachable** problem, but there are standardized solutions for that.

### How to get a valid https endpoint routed to a personal computer behind NAT

The options I know are: Tailscale funnel, cloudflare tunnels and ngrok.

Tailscale funnel is the one I have tested and, in general terms, only requires:
  - Install tailscale
  - run `tailscale funnel <local port>
  - click accept several times the first time it's run to enable it
  
That is all. The bad news is that the moment you enable it, you start getting scans looking vulnerabilities (brute-force hacking attempts), because the creation of the certificate signals its existence. May be the other solutions don't have this problem, I don't know.

### How to configure GitHub for OAuth

Assuming you have an account. Go to https://github.com/settings/developers and create a new App:

 - Client ID and Client Secret are generated by GitHub (write them down securely)
 - App Name (something like "MCP for Laptop" should suffice)
 - HomePage URL. This is where you will be sent after form validation: https://chatgpt.com/connector_platform_oauth_redirect
 - Authorization callback URL: Use https://<server>.<tailnetname>.ts.net/auth/callback

